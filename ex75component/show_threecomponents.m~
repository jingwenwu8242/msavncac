clear all; 

xright=2.0; yright=2.0; xleft = 0; yleft = 0; nx=128*2; ny = 128*2;h= (xright-xleft)/nx;
x=linspace(xleft+0.5*h,xright-0.5*h,nx); y=linspace(yleft+0.5*h,yright-0.5*h,ny);
[xx,yy]=meshgrid(x,y);


ss=sprintf('/Users/wujingwen/research/fluid_mechanics/SAV+multi-component incompressible fluid system/msav+nc/data_output/codephase_separation/datac.m'); phi = load(ss);
ss=sprintf('/Users/wujingwen/research/fluid_mechanics/SAV+multi-component incompressible fluid system/msav+nc/data_output/codephase_separation/datac2.m'); phi2 = load(ss);
ss=sprintf('/Users/wujingwen/research/fluid_mechanics/SAV+multi-component incompressible fluid system/msav+nc/data_output/codephase_separation/datac3.m'); phi3 = load(ss);
ss=sprintf('/Users/wujingwen/research/fluid_mechanics/SAV+multi-component incompressible fluid system/msav+nc/data_output/codephase_separation/Mene.m');EnEM= load(ss);
ss= sprintf('/Users/wujingwen/research/fluid_mechanics/SAV+multi-component incompressible fluid system/msav+nc/data_output/codephase_separation/Oene.m');EnEO=load(ss);

n=size(phi,1)/nx;


ii=0;
for i = 1:16
    
    
 % figure(i+1);
clf;

A = phi((i-1)*nx+1:i*nx,:);
B = phi2((i-1)*nx+1:i*nx,:);
C = 1-A-B;

% for i = 1:nx
%     for j = 1:ny
%         
%         if( A(i,j) > 1.0)
%             A(i,j) = 1.0;
%         elseif( A(i,j) < -1.0)
%             A(i,j) = -1.0;
%         else
%             A(i,j) = A(i,j);
%         end
%     end
% end

hh=contourf(xx,yy,A',[0.5 0.5],'facecolor','k','edgecolor','k'); hold on;
hh2=contourf(xx,yy,B',[0.5 0.5],'facecolor',[0.8 0.8 0.8],'edgecolor','k'); hold on;
hh3=contourf(xx,yy,C',[0.5 0.5],'facecolor',[0.5 0.5 0.5],'edgecolor','k'); hold on;



% view(0,90);
% surf(xx,yy,0.5*A'+B');
% shading interp;
% colormap jet;
plot(t(1:1:36),EnEM(1:1:36),'k-','linewidth',1.0);hold on;
plot(t(1:1:36),EnEO(1:1:36),'k*','linewidth',1.0);hold on;

axis image; axis([0 xright 0 yright]); 
box on

pause(0.6);

end

